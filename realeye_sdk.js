var t = { d: (e, n) => { for (var i in n) t.o(n, i) && !t.o(e, i) && Object.defineProperty(e, i, { enumerable: !0, get: n[i] }) }, o: (t, e) => Object.prototype.hasOwnProperty.call(t, e) }, e = {}; function n(t, e) { var n = "undefined" != typeof Symbol && t[Symbol.iterator] || t["@@iterator"]; if (!n) { if (Array.isArray(t) || (n = function (t, e) { if (t) { if ("string" == typeof t) return i(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? i(t, e) : void 0 } }(t)) || e && t && "number" == typeof t.length) { n && (t = n); var o = 0, r = function () { }; return { s: r, n: function () { return o >= t.length ? { done: !0 } : { done: !1, value: t[o++] } }, e: function (t) { throw t }, f: r } } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") } var s, l = !0, c = !1; return { s: function () { n = n.call(t) }, n: function () { var t = n.next(); return l = t.done, t }, e: function (t) { c = !0, s = t }, f: function () { try { l || null == n.return || n.return() } finally { if (c) throw s } } } } function i(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, i = Array(e); n < e; n++)i[n] = t[n]; return i } function o(t) { return o = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, o(t) } function r(t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(t, s(i.key), i) } } function s(t) { var e = function (t, e) { if ("object" != o(t) || !t) return t; var n = t[Symbol.toPrimitive]; if (void 0 !== n) { var i = n.call(t, e || "default"); if ("object" != o(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value.") } return ("string" === e ? String : Number)(t) }(t, "string"); return "symbol" == o(e) ? e : e + "" } t.d(e, { A: () => B, o: () => P }); var l, c, a, u, h, d, m, f, v, E, w, y, p, g, I, b, T, R, A, O, _, N, S, M, x, W, k, H, X, Y, L, V, U, C = function (t, e, n, i, o) { if ("m" === i) throw new TypeError("Private method is not writable"); if ("a" === i && !o) throw new TypeError("Private accessor was defined without a setter"); if ("function" == typeof e ? t !== e || !o : !e.has(t)) throw new TypeError("Cannot write private member to an object whose class did not declare it"); return "a" === i ? o.call(t, n) : o ? o.value = n : e.set(t, n), n }, D = function (t, e, n, i) { if ("a" === n && !i) throw new TypeError("Private accessor was defined without a getter"); if ("function" == typeof e ? t !== e || !i : !e.has(t)) throw new TypeError("Cannot read private member from an object whose class did not declare it"); return "m" === n ? i : "a" === n ? i.call(t) : i ? i.value : e.get(t) }, P = function () { return t = function t() { var e = this, n = arguments.length > 0 && void 0 !== arguments[0] && arguments[0], i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : null, o = arguments.length > 2 && void 0 !== arguments[2] && arguments[2]; !function (t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }(this, t), l.add(this), this.VERSION = "1.8.0", this.VERSION_RE = "18.29.0", this.TARGET_ORIGIN = "*", a.set(this, null), u.set(this, void 0), h.set(this, !1), d.set(this, void 0), m.set(this, void 0), f.set(this, 5), this.setStimulusId = function (t) { return C(e, a, t, "f") }, this.getStimulusId = function () { return D(e, a, "f") }, C(this, m, n, "f"), C(this, d, o, "f"), this.currentUrl = window.location.href, C(this, u, new Map, "f"), D(this, l, "m", U).call(this, "Initializing EmbeddedPageSdk (version " + this.VERSION + ")"), D(this, l, "m", Y).call(this) ? (this.setStimulusId(i), this.startNextExposure(), D(this, l, "m", M).call(this), D(this, l, "m", E).call(this)) : D(this, l, "m", U).call(this, "WARNING: This page was not opened by RealEye. No data will be send to testRunner.") }, (e = [{ key: "startNextExposure", value: function () { D(this, l, "m", O).call(this), D(this, l, "m", A).call(this), D(this, l, "m", v).call(this) } }, { key: "finishEyeTrackingTest", value: function () { var t = this; C(this, h, !1, "f"), D(this, l, "m", Y).call(this) ? (D(this, l, "m", U).call(this, "Sending a message to RealEye to end this eye-tracking test."), setTimeout((function () { return window.parent.postMessage("re-test-end-without-interaction", t.TARGET_ORIGIN) }), 500)) : D(this, l, "m", U).call(this, "This page was not opened by RealEye so eye-tracking test cannot be finished.") } }, { key: "enableVirtualChin", value: function (t) { window.parent.postMessage({ type: "re-virtual-chin-disabled", version: this.VERSION, body: JSON.stringify(!t) }, this.TARGET_ORIGIN) } }, { key: "sendUserInteraction", value: function (t) { window.parent.postMessage({ type: "re-user-interaction", version: this.VERSION, body: JSON.stringify(t) }, this.TARGET_ORIGIN) } }, { key: "sendZoomTransform", value: function (t, e, n) { var i = { scale: t, translateX: e, translateY: n, timestampMs: Date.now() }; window.parent.postMessage({ type: "re-zoom-transform", version: this.VERSION, body: JSON.stringify(i) }, this.TARGET_ORIGIN) } }]) && r(t.prototype, e), n && r(t, n), Object.defineProperty(t, "prototype", { writable: !1 }), t; var t, e, n }(); c = P, a = new WeakMap, u = new WeakMap, h = new WeakMap, d = new WeakMap, m = new WeakMap, f = new WeakMap, l = new WeakSet, v = function () { var t = this; D(this, l, "m", U).call(this, "Sending dynamic AOI Logs to testRunner."), document.querySelectorAll("[".concat(c.REIO_AOI_ATTRIBUTE_NAME, "]")).forEach((function (e) { var n = e, i = n.dataset[c.REIO_AOI_DATASET_NAME]; D(t, l, "m", X).call(t, i, D(t, l, "m", R).call(t, n, i)) })) }, E = function () { var t = this, e = function (e, n) { var i = null, o = e.getAttribute(c.REIO_AOI_ATTRIBUTE_NAME); (i = D(t, l, "m", R).call(t, e, o)).isInViewport = n, D(t, l, "m", X).call(t, o, i) }, i = new MutationObserver((function (t, o) { var r, s = n(t); try { for (s.s(); !(r = s.n()).done;) { var l = r.value; "childList" == l.type && (l.addedNodes.forEach((function (t) { t instanceof HTMLElement && t.hasAttribute(c.REIO_AOI_ATTRIBUTE_NAME) && (e(t, !0), i.observe(t, { attributes: !0, attributeFilter: [c.REIO_AOI_ATTRIBUTE_NAME], childList: !0, subtree: !0 })) })), l.removedNodes.forEach((function (t) { t instanceof HTMLElement && t.hasAttribute(c.REIO_AOI_ATTRIBUTE_NAME) && e(t, !1) }))), l.target instanceof HTMLElement && l.attributeName === c.REIO_AOI_ATTRIBUTE_NAME && e(l.target, null !== l.target.getAttribute(c.REIO_AOI_ATTRIBUTE_NAME)) } } catch (t) { s.e(t) } finally { s.f() } })); document.querySelectorAll("*").forEach((function (t) { i.observe(t, { attributes: !0, attributeFilter: [c.REIO_AOI_ATTRIBUTE_NAME], childList: !0, subtree: !0 }) })); C(this, h, !0, "f"); var o = Math.round(1e3 / D(this, f, "f")); D(this, l, "m", w).call(this, o, (function () { var e = Date.now(); D(t, l, "m", U).call(t, "Running: checkAllElements"), document.querySelectorAll("[".concat(c.REIO_AOI_ATTRIBUTE_NAME, "]")).forEach((function (e) { return function (e) { var n = e.dataset[c.REIO_AOI_DATASET_NAME], i = Object.assign({}, D(t, l, "m", y).call(t, n)), o = D(t, l, "m", I).call(t, e), r = D(t, l, "m", g).call(t, e), s = D(t, l, "m", b).call(t, e), a = D(t, l, "m", T).call(t, e.getBoundingClientRect(), i) || !o; i.isInViewport === o && i.hasFixedPosition === r && i.zIndex === s && a || (i.context.window.scrollX = window.scrollX, i.context.window.scrollY = window.scrollY, i.isInViewport = o, i.hasFixedPosition = r, i.zIndex = s, i.boundingClientRect = D(t, l, "m", p).call(t, e), i.timestampMs = Date.now(), i.stimulusTimestampMs = Date.now(), D(t, l, "m", X).call(t, n, i)) }(e) })); var n = Date.now() - e; D(t, l, "m", U).call(t, "checkAllElements took ".concat(n, " ms")) }), Date.now()) }, w = function t(e, n, i) { var o = this; if (D(this, h, "f")) { D(this, l, "m", U).call(this, "Running: #elementWatcherLoop"); var r = Date.now() - i, s = e; (s = r >= e ? 0 : e - r) <= 5 && (s = 0), window.setTimeout((function () { D(o, l, "m", U).call(o, "Running: #elementWatcherLoop setTimeout callback"), n(), D(o, l, "m", t).call(o, e, n, Date.now()) }), s) } }, y = function (t) { var e = void 0; if (D(this, u, "f").has(t)) e = D(this, u, "f").get(t); else { var n = document.querySelectorAll("[".concat(c.REIO_AOI_ATTRIBUTE_NAME, "='").concat(t, "']"))[0]; e = D(this, l, "m", R).call(this, n, t), D(this, u, "f").set(t, e) } return e }, p = function (t) { var e = t.getBoundingClientRect(); return new DOMRect(e.x + window.scrollX, e.y + window.scrollY, e.width, e.height) }, g = function (t) { var e = getComputedStyle(t), n = e.position.includes("sticky") && t.getBoundingClientRect().y <= 0; return e.position.includes("fixed") || n }, I = function (t) { return "none" !== t.style.display && "hidden" !== t.style.visibility && t.offsetHeight > 0 && t.offsetWidth > 0 && t.getClientRects().length > 0 }, b = function (t) { var e = Number(getComputedStyle(t).zIndex); if (!isNaN(e)) return e; for (var n = 0; t !== document.body;)t = t.parentElement, n++; return n }, T = function (t, e) { var n = new DOMRect(e.boundingClientRect.x - window.scrollX, e.boundingClientRect.y - window.scrollY, e.boundingClientRect.width, e.boundingClientRect.height); return t.x == n.x && t.y == n.y && t.width == n.width && t.height == n.height }, R = function (t, e) { return { context: { reSdk: { version: this.VERSION }, window: { devicePixelRatio: window.devicePixelRatio, scrollX: window.scrollX, scrollY: window.scrollY }, documentElement: { offsetWidth: D(this, l, "m", V).call(this), offsetHeight: D(this, l, "m", L).call(this), clientWidth: document.documentElement.clientWidth, clientHeight: document.documentElement.clientHeight } }, aoi: { name: e }, stimulus: { uri: window.location.href }, timestampMs: Date.now(), stimulusTimestampMs: Date.now(), isInViewport: D(this, l, "m", I).call(this, t), hasFixedPosition: D(this, l, "m", g).call(this, t), zIndex: D(this, l, "m", b).call(this, t), boundingClientRect: D(this, l, "m", p).call(this, t) } }, A = function () { var t = document.querySelectorAll("[".concat(c.REIO_AOI_ATTRIBUTE_NAME, "]")); D(this, l, "m", U).call(this, "Watched Dynamic AOI count: " + t.length); var e, i = n(t); try { for (i.s(); !(e = i.n()).done;) { var o = e.value; D(this, l, "m", U).call(this, o) } } catch (t) { i.e(t) } finally { i.f() } }, O = function () { D(this, a, "f") ? D(this, l, "m", N).call(this) : D(this, l, "m", _).call(this) }, _ = function () { var t = { uri: this.currentUrl, reSdk: { version: this.VERSION, reVersion: this.VERSION_RE }, documentElement: { offsetWidth: D(this, l, "m", V).call(this), offsetHeight: D(this, l, "m", L).call(this), clientWidth: document.documentElement.clientWidth, clientHeight: document.documentElement.clientHeight } }; D(this, l, "m", H).call(this, "re-uri-exposure", t) }, N = function () { var t = { stimulusId: D(this, a, "f"), reSdk: { version: this.VERSION, reVersion: this.VERSION_RE }, documentElement: { offsetWidth: D(this, l, "m", V).call(this), offsetHeight: D(this, l, "m", L).call(this), clientWidth: document.documentElement.clientWidth, clientHeight: document.documentElement.clientHeight } }; D(this, l, "m", H).call(this, "re-stimulus-id-exposure", t) }, S = function () { window.location.href !== this.currentUrl && (this.currentUrl = window.location.href, this.startNextExposure()) }, M = function () { var t = this, e = function (e) { return D(t, l, "m", x).call(t, e) }, n = function (e) { return D(t, l, "m", W).call(t, e) }; document.addEventListener("mousemove", e), document.addEventListener("mouseenter", e), document.addEventListener("mouseleave", e), document.addEventListener("click", e), document.addEventListener("dblclick", e), document.addEventListener("mousedown", e), document.addEventListener("mouseup", e), document.addEventListener("touchstart", n), document.addEventListener("touchend", n), document.addEventListener("scroll", (function (e) { return D(t, l, "m", k).call(t) })), setInterval((function () { D(t, l, "m", S).call(t) }), 100) }, x = function (t) { var e = { button: t.button, buttons: t.buttons, clientX: t.clientX, clientY: t.clientY, movementX: t.movementX, movementY: t.movementY, screenX: t.screenX, screenY: t.screenY }, n = { type: t.type, mouseEventInit: e }; D(this, l, "m", H).call(this, "re-dom-event", n) }, W = function (t) { var e, i = function (t) { return { identifier: t.identifier, screenX: t.screenX, screenY: t.screenY, clientX: t.clientX, clientY: t.clientY, pageX: t.pageX, pageY: t.pageY } }, o = [], r = n(t.changedTouches); try { for (r.s(); !(e = r.n()).done;) { var s = e.value; o.push(i(s)) } } catch (t) { r.e(t) } finally { r.f() } var c, a = [], u = n(t.targetTouches); try { for (u.s(); !(c = u.n()).done;) { var h = c.value; a.push(i(h)) } } catch (t) { u.e(t) } finally { u.f() } var d, m = [], f = n(t.touches); try { for (f.s(); !(d = f.n()).done;) { var v = d.value; m.push(i(v)) } } catch (t) { f.e(t) } finally { f.f() } var E = { type: t.type, touchEventInit: { changedTouches: o, targetTouches: a, touches: m } }; D(this, l, "m", H).call(this, "re-dom-event", E) }, k = function () { var t = { type: "scroll", scrollX: window.scrollX, scrollY: window.scrollY, documentElement: { offsetWidth: D(this, l, "m", V).call(this), offsetHeight: D(this, l, "m", L).call(this), clientWidth: document.documentElement.clientWidth, clientHeight: document.documentElement.clientHeight } }; D(this, l, "m", H).call(this, "re-dom-event", t) }, H = function (t, e) { D(this, l, "m", Y).call(this) ? window.parent.postMessage({ type: t, version: this.VERSION, body: JSON.stringify(e) }, this.TARGET_ORIGIN) : D(this, l, "m", U).call(this, "This page was not opened by RealEye so no message will be send to testRunner.") }, X = function (t, e) { D(this, l, "m", U).call(this, e), D(this, u, "f").set(t, e), D(this, l, "m", H).call(this, "re-aoi-position-logs", e) }, Y = function () { return D(this, d, "f") || window.top !== window }, L = function () { return Math.max(document.body.scrollHeight, document.body.offsetHeight, document.documentElement.clientHeight, document.documentElement.scrollHeight, document.documentElement.offsetHeight) }, V = function () { return Math.max(document.body.scrollWidth, document.body.offsetWidth, document.documentElement.clientWidth, document.documentElement.scrollWidth, document.documentElement.offsetWidth) }, U = function (t) { D(this, m, "f") && console.log(t) }, P.REIO_AOI_ATTRIBUTE_NAME = "data-re-aoi-name", P.REIO_AOI_DATASET_NAME = "reAoiName"; const B = P; var G = e.o, j = e.A; export { G as EmbeddedPageSdk, j as default };